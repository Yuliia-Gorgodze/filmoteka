"use strict";var genres,movieGallery=document.querySelector("#js-moviesList"),libraryGallery=document.querySelector("#js-library"),searchField=document.querySelector("#js-form"),searchInput=document.querySelector("#search"),moviesList=document.querySelector("#js-moviesList"),detailsPage=document.querySelector("#js-detailsPage"),homePage=document.querySelector("#js-homePage"),headerError=document.querySelector(".error-message"),detailsModal=document.querySelector("#js-detailsPage"),detailsPreviewImg=document.querySelector("#js-previewImg"),detailsVote=document.querySelector("#js-detailsVote"),detailsVotes=document.querySelector("#js-detailsVotes"),detailsTitle=document.querySelector(".details-title"),detailsDescription=document.querySelector("#js-detailsText"),detailsPopularuty=document.querySelector("#details-popularity"),detailsOriginalTitle=document.querySelector("#details-originalTitle"),movieTrailer=document.getElementById("js-movieTrailer"),buttonLeftRef=document.querySelector('.pagination__button[data-index = "left"]'),buttonRightRef=document.querySelector('.pagination__button[data-index = "right"]'),buttonOneRef=document.querySelector('.pagination__button[data-index = "1"]'),buttonTwoRef=document.querySelector('.pagination__button[data-index = "2"]'),buttonThreeRef=document.querySelector('.pagination__button[data-index = "3"]'),buttonFourRef=document.querySelector('.pagination__button[data-index = "4"]'),buttonFiveRef=document.querySelector('.pagination__button[data-index = "5"]'),body=document.querySelector("body"),apiKey="5f4a8cd7bcedd7efa785bad615b94f98",inputValue="",pageNumber=1,renderedMovies=[];function createMarkup(){addPreloader(),fetchFilms().then(function(e){return""===inputValue?(removePreloader(),void(headerError.textContent="Please enter movie name")):(moviesList.innerHTML="",headerError.textContent="",e.results.forEach(function(e){fetchMoviesId(e.id).then(function(e){moviesList.insertAdjacentHTML("beforeend",createCard(e.poster_path,e.title,e.id,e.release_date,e.vote_average,e.budget,e.revenue,e.genres))})}),0===e.results.length&&(removePreloader(),headerError.textContent="No movies were found. Please specify your request",createStartupMarkup()),removePreloader(),renderedMovies=e.results)})}function createStartupMarkup(){addPreloader(),fetchPopularFilms().then(function(e){return moviesList.innerHTML="",e.results.forEach(function(e){fetchMoviesId(e.id).then(function(e){moviesList.insertAdjacentHTML("beforeend",createCard(e.poster_path,e.title,e.id,e.release_date,e.vote_average,e.budget,e.revenue,e.genres))})}),removePreloader(),renderedMovies=e.results})}function createCard(e,t,o,a,n,r,i,s){var l=document.createElement("li");l.classList.add("main__movieItem"),l.setAttribute("id","js-movieItem");var d=document.createElement("img");d.classList.add("main__previewImgItem"),e?d.setAttribute("src","https://image.tmdb.org/t/p/w500/".concat(e)):d.setAttribute("src","./images/plug.jpg"),d.setAttribute("data-id",o),d.setAttribute("id","js-image");var c=document.createElement("h2");c.classList.add("main__previewImgTitle");var u=document.createElement("div");u.classList.add("main__previewTitleContainer"),u.append(c);var m=document.createElement("button");m.classList.add("btn-delete"),m.classList.add("hidden"),m.setAttribute("type","button"),m.innerHTML='<svg class="svg-delete" width="24" height="24">\n  <use href="./images/symbol-defs2.svg#icon-iconfinder_trash_115789"></use>\n</svg>',"activeLibraryPage"===localStorage.getItem("activePage")?m.classList.remove("hidden"):m.classList.add("hidden");var v=createShortDescription(n,a,r,i,s),g=new Date(a).getFullYear();return Number.isNaN(g)?c.textContent=t:c.textContent="".concat(t," (").concat(g,")"),l.append(d,u,v,m),l.outerHTML}function createShortDescription(e,t,o,a,n){var r=n.reduce(function(e,t){return e+"".concat(t.name,", ")},"").slice(0,-2),i=document.createElement("div");return i.classList.add("main__previewInfoBlock"),i.innerHTML='\n  <h2 id="js-minicardVotes" class="minicard__title">Avarage raiting</h2>\n<span class="minicard__description">'.concat(e,'</span>\n<h2 id="js-minicardReleaseDate" class="minicard__title">Release date</h2>\n<p class="minicard__description">').concat(t,'</p>\n<h2 id="js-minicardRevenue" class="minicard__title">Genres</h2>\n<p class="minicard__description">').concat(r,"</p>"),i}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}var debounce=function(o,a){var n;return function(){var e=arguments,t=this;clearTimeout(n),n=setTimeout(function(){o.apply(t,e)},a)}};function inputChange(){0!=searchInput.value.length&&(inputValue=searchInput.value,dischargePaginationAndCreateMarkup())}function fetchFilms(){return fetch("https://api.themoviedb.org/3/search/movie?api_key=".concat(apiKey,"&language=en-US&page=").concat(pageNumber,"&include_adult=false&query=").concat(inputValue)).then(function(e){return e.json()}).then(function(e){return 0!=e.results.length&&scrollToSectionHomePage(),e})}function fetchPopularFilms(){return fetch("https://api.themoviedb.org/3/movie/popular?api_key=".concat(apiKey,"&language=en-US&page=").concat(pageNumber)).then(function(e){return e.json()}).then(function(e){return e})}function fetchGenres(){fetch("https://api.themoviedb.org/3/genre/movie/list?api_key=".concat(apiKey,"&language=en-US")).then(function(e){return e.json()}).then(function(e){genres=_toConsumableArray(e.genres)}).catch(function(e){return console.log(e)})}function fetchMovies(e){return fetch("https://api.themoviedb.org/3/movie/".concat(e,"/videos?api_key=").concat(apiKey,"&language=en-US")).then(function(e){return e.json()}).then(function(e){return 0!==e.results.length&&e.results[0].key?e.results[0].key:null})}function fetchMoviesId(e){return fetch("https://api.themoviedb.org/3/movie/".concat(e,"?api_key=").concat(apiKey,"&language=en-US")).then(function(e){return e.json()}).then(function(e){return e})}function paginationNavigation(e){pageNumber=e[2],""===inputValue?createStartupMarkup():createMarkup()}searchInput.addEventListener("input",debounce(inputChange,1200)),searchField.addEventListener("submit",function(e){e.preventDefault(),inputValue=e.currentTarget.elements[0].value,dischargePaginationAndCreateMarkup()});var myLibraryLink=document.querySelector(".link-library"),myLibraryPage=document.querySelector(".my-library-page"),myLibraryHeaderDiv=document.querySelector(".my-library-header-div"),header=document.querySelector("header"),homePageLink=document.querySelector(".link-header"),homePageLogo=document.querySelector(".link-logo");function myLibraryLinkClick(){libraryListener(),libraryGallery.addEventListener("click",openLibraryMovieDetails)}function activeHomePage(){inputValue="",dischargePaginationAndCreateMarkup(),myLibraryLink.classList.remove("current"),homePageLink.classList.add("current"),homePage.classList.remove("hidden"),myLibraryPage.classList.add("hidden"),searchField.classList.remove("hidden"),header.classList.add("header"),header.classList.remove("my-library-header"),myLibraryHeaderDiv.classList.add("hidden"),localStorage.setItem("activePage","activeHomePage"),movieGallery.addEventListener("click",onFilmCardClickHandler),libraryGallery.removeEventListener("click",openLibraryMovieDetails)}function activeLibraryPage(){myLibraryLink.classList.add("current"),homePageLink.classList.remove("current"),homePage.classList.add("hidden"),myLibraryPage.classList.remove("hidden"),searchField.classList.add("hidden"),header.classList.remove("header"),header.classList.add("my-library-header"),myLibraryHeaderDiv.classList.remove("hidden"),headerError.innerHTML="",localStorage.setItem("activePage","activeLibraryPage"),libraryGallery.addEventListener("click",openLibraryMovieDetails),movieGallery.removeEventListener("click",onFilmCardClickHandler)}myLibraryLink.addEventListener("click",myLibraryLinkClick),homePageLink.addEventListener("click",activeHomePage),homePageLogo.addEventListener("click",activeHomePage),"activeLibraryPage"===localStorage.getItem("activePage")?(activeLibraryPage(),libraryGallery.addEventListener("click",openLibraryMovieDetails),movieGallery.removeEventListener("click",onFilmCardClickHandler)):"activeHomePage"===localStorage.getItem("activePage")&&(activeHomePage(),libraryGallery.removeEventListener("click",openLibraryMovieDetails),movieGallery.addEventListener("click",onFilmCardClickHandler));var watchedFilms=document.querySelector(".watched-list"),watchedButton=document.querySelector("#watched"),queueButton=document.querySelector("#queue"),deleteFromCardBtn=document.querySelectorAll("btn-delete");watchedButton.addEventListener("click",drawWatchedFilmList),queueButton.addEventListener("click",drawQueueFilmList);var watchedAndQueueFilms=[];function drawWatchedFilmList(){activePage(watchedButton,queueButton),watchedFilms.innerHTML="";var e=JSON.parse(localStorage.getItem("filmsWatched"));null===e||0===e.length?watchedFilms.innerHTML='<img class="catch-error-pagination" src="./images/image1.jpg" />':createWatchCard(e)}function drawQueueFilmList(){activePage(queueButton,watchedButton),watchedFilms.innerHTML="";var e=JSON.parse(localStorage.getItem("filmsQueue"));null===e||0===e.length?watchedFilms.innerHTML='<img class="catch-error-pagination" src="./images/image1.jpg" />':createQueqeCard(e)}function createWatchCard(e){e.forEach(function(e){fetchMoviesId(e).then(function(e){watchedAndQueueFilms.push(e),watchedFilms.insertAdjacentHTML("beforeend",createCard(e.poster_path,e.title,e.id,e.release_date,e.vote_average,e.budget,e.revenue,e.genres))})})}function createQueqeCard(e){e.forEach(function(e){fetchMoviesId(e).then(function(e){watchedAndQueueFilms.push(e),watchedFilms.insertAdjacentHTML("beforeend",createCard(e.poster_path,e.title,e.id,e.release_date,e.vote_average,e.budget,e.revenue,e.genres))})})}function activePage(e,t){e.classList.add("button-active"),t.classList.remove("button-active")}function libraryListener(){activeLibraryPage(),drawWatchedFilmList()}function openLibraryMovieDetails(e){if("IMG"===e.target.nodeName){var t=e.target.dataset.id;activateDetailsPage(t,!0),toggleButtonWatcher(t)}}function deleteFromCard(e){var t,o=JSON.parse(localStorage.getItem("filmsWatched")),a=JSON.parse(localStorage.getItem("filmsQueue"));if("use"===e.target.nodeName||"svg"===e.target.nodeName||"BUTTON"===e.target.nodeName){var n=(t="BUTTON"===e.target.parentNode.nodeName?e.target.parentNode.parentNode:"use"===e.target.nodeName?e.target.parentNode.parentNode.parentNode:e.target.parentNode).querySelector("img").dataset.id;myLibraryLink.classList.contains("current")&&queueButton.classList.contains("button-active")&&a.includes(n)&&(removeUserQueueFilm(n),console.log("filmsQueueFromLocalStorage ",a),a=a.filter(function(e){return e!==n}),localStorage.setItem("filmsQueue",JSON.stringify(a)),t.parentNode.removeChild(t)),myLibraryLink.classList.contains("current")&&watchedButton.classList.contains("button-active")&&o.includes(n)&&(removeUserWatchedFilm(n),o=o.filter(function(e){return e!==n}),localStorage.setItem("filmsWatched",JSON.stringify(o)),t.parentNode.removeChild(t))}}function removePreloader(){document.querySelector(".loader").classList.add("is-hidden")}function addPreloader(){document.querySelector(".loader").classList.remove("is-hidden")}"activeLibraryPage"===localStorage.getItem("activePage")&&libraryListener(),myLibraryPage.addEventListener("click",deleteFromCard);var modal,closeModalBtn,modalCollaboratorsList,shadow,timeout,FOCUSABLE_SELECTORS="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]",openModalBtn=document.querySelector(".open-modal"),main=document.querySelector("main"),html=(header=document.querySelector("header"),document.documentElement),scrollPosition=window.pageYOffset;function scrollPositionOnOpen(){scrollPosition=window.pageYOffset,html.style.top=-scrollPosition+"px"}function scrollPositionOnClose(){html.classList.remove("modal__opened"),window.scrollTo(0,scrollPosition),html.style.top=""}function fetchFilmModal(e){return fetch("https://api.themoviedb.org/3/search/movie?api_key=".concat(apiKey,"&language=en-US&include_adult=false&query=").concat(e)).then(function(e){return e.json()}).then(function(e){return e})}function modalCollaboratorFilm(e){e.target.classList.contains("modal-card_btn_text")&&fetchFilmModal(e.target.textContent||"alibi.com").then(function(e){var t=e.results;console.log("RESULTS ",t[0]),openMovieDetails(t[0])}).catch(function(e){return"ERROR ".concat(e)})}function focusCatcher(e){e.querySelectorAll(FOCUSABLE_SELECTORS).forEach(function(e){return e.setAttribute("tabindex","-1")})}function focusSet(e){e.querySelectorAll(FOCUSABLE_SELECTORS).forEach(function(e){return e.removeAttribute("tabindex")})}function trapScreenReaderFocus(e){e.removeAttribute("aria-hidden"),main.setAttribute("aria-hidden","true"),header.setAttribute("aria-hidden","true")}function untrapScreenReaderFocus(e){e.setAttribute("aria-hidden","true"),main.removeAttribute("aria-hidden"),header.removeAttribute("aria-hidden")}function bodyScrollControlShift(){var e=window.innerWidth-html.clientWidth;html.style.marginRight=e?e+"px":""}function onOverlayClickClose(e){e.target.classList.contains("modal-wrap")&&(e.preventDefault(),closeModalWindow())}function onEscapeClose(e){if(27==e.which&&modal.classList.contains("modal--active"))return e.preventDefault(),void closeModalWindow()}function markup(e,o){return e.reduce(function(e,t){return e+=o(t)},"")}var cursorHandler={currentElem:null,mouseCursor:document.getElementById("cursor"),onmouseover:function(e){var t=e.target.closest("button")||e.target.closest("a");t&&body.contains(t)&&(this.currentElem=t,mouseCursor.classList.add("cursor"),mouseCursor.classList.remove("cursor-n"),body.classList.add("cursor-none"))},onmouseout:function(e){if(this.currentElem){for(var t=e.relatedTarget;t;){if(t==!this.currentElem)return;t=t.parentNode}cursorHandler.onclose(),this.currentElem=null}},onclose:function(){mouseCursor.classList.remove("cursor"),mouseCursor.classList.add("cursor-n"),body.classList.remove("cursor-none")},mousemove:function(e){mouseCursor.style.top=e.pageY+scrollPosition+"px",mouseCursor.style.left=e.pageX+"px"}};function shadowShow(){shadow||((shadow=document.createElement("div")).classList.add("modal__shadow"),document.body.appendChild(shadow))}function openModalWindow(){document.body.insertAdjacentHTML("beforeend",createModalWindow()),modal=document.querySelector(".modal"),closeModalBtn=document.querySelector(".close-modal"),(modalCollaboratorsList=document.querySelector(".modal-our_team_list")).insertAdjacentHTML("beforeend",markup(collaborators,renderCollaboratorCard)),timeout=setTimeout(function(){modal.classList.add("modal--active")},500),shadowShow(),window.removeEventListener("mousemove",cursor),window.addEventListener("mousemove",cursorHandler.mousemove),modal.addEventListener("mouseover",cursorHandler.onmouseover),modal.addEventListener("mouseout",cursorHandler.onmouseout),cursorHandler.onclose(),toTopBtn&&toTopBtn.classList.remove("show"),focusCatcher(html),getStorage(),closeModalBtn.addEventListener("click",closeModalWindow),document.addEventListener("click",onOverlayClickClose),window.addEventListener("keydown",onEscapeClose),openModalBtn.removeEventListener("click",openModalWindow),modalCollaboratorsList.addEventListener("click",modalCollaboratorFilm),modal.querySelector(FOCUSABLE_SELECTORS).focus(),focusSet(modal),bodyScrollControlShift(),scrollPositionOnOpen(),html.classList.add("modal__opened"),trapScreenReaderFocus(modal)}function closeModalWindow(){modal.classList.add("modal--moved"),modal.addEventListener("transitionend",transitionClose),modal.classList.remove("modal--active"),closeModalBtn.removeEventListener("click",closeModalWindow)}function transitionClose(){modal.classList.remove("modal--moved"),modalCollaboratorsList.innerHTML="",modal.removeEventListener("transitionend",transitionClose),document.removeEventListener("click",onOverlayClickClose),window.removeEventListener("keydown",onEscapeClose),modalCollaboratorsList.removeEventListener("click",modalCollaboratorFilm),window.removeEventListener("mousemove",cursorHandler.mousemove),modal.removeEventListener("mouseover",cursorHandler.onmouseover),modal.removeEventListener("mouseout",cursorHandler.onmouseout),cursorHandler.onclose(),window.addEventListener("mousemove",cursor),openModalBtn.addEventListener("click",openModalWindow),focusSet(html),bodyScrollControlShift(),scrollPositionOnClose(),untrapScreenReaderFocus(modal),openModalBtn.focus(),body.removeChild(modal),body.removeChild(shadow),clearTimeout(timeout),timeout=modal=shadow=null}openModalBtn.addEventListener("click",openModalWindow);var pageCarousel="1";function Carousel(e,t,o,a,n){var r=0,i=document.querySelector(e),s=document.querySelectorAll(o).length,l=document.querySelector(a),d=document.querySelector(n),c=document.querySelector(t);function u(e){r+=e,c.style.left=r+"px"}return i.classList.add("frame"),c.classList.add("slider"),l.addEventListener("click",function(){carousel.left()}),d.addEventListener("click",function(){carousel.right()}),{right:function(){-3100<r?u(-199):(r=s-1,c.style.left=r+"px",pageCarousel=Number(pageCarousel)+1,getUpcomingFilms(pageCarousel+=""))},left:function(){0===r?u(0):r<0?u(200):(r=s-1,c.style.left=r+"px")}}}var carousel=new Carousel("#frame","#slider","#slider .slide",".arrowLeft",".arrowRight"),getUpcomingFilms=function(e){fetch("https://api.themoviedb.org/3/movie/upcoming?api_key=".concat(apiKey,"&language=en-US&page=").concat(e)).then(function(e){return e.json()}).then(function(e){var t=document.querySelector("#slider");e.results.map(function(e){t.innerHTML+='<div class="slider-box slide">\n                  <div class="slider-photo">\n                    <a href="#" class="carousel-link">\n                      <img src="https://image.tmdb.org/t/p/w200'.concat(e.poster_path,'" class="img-carousel" />\n                    </a>\n                    <p class="release-date">Available from</br>"').concat(e.release_date,'"</p>\n                  </div>')})}).catch(function(e){console.log(e)})};getUpcomingFilms(pageCarousel),setInterval(function(){carousel.right()},3e3);var mouseCursor=document.getElementById("cursor");mouseCursor.classList.remove("cursor"),mouseCursor.classList.add("cursor-n"),body.classList.remove("cursor-none");var navLinks=document.querySelectorAll("a"),button=document.querySelectorAll("button");body=document.querySelector("body");function cursor(e){mouseCursor.style.top=e.pageY+"px",mouseCursor.style.left=e.pageX+"px"}window.addEventListener("mousemove",cursor),navLinks.forEach(function(e){e.addEventListener("mouseleave",function(){mouseCursor.classList.remove("cursor"),mouseCursor.classList.add("cursor-n"),body.classList.remove("cursor-none")}),e.addEventListener("mouseover",function(){mouseCursor.classList.add("cursor"),mouseCursor.classList.remove("cursor-n"),body.classList.add("cursor-none")})}),button.forEach(function(e){e.addEventListener("mouseleave",function(){mouseCursor.classList.remove("cursor"),mouseCursor.classList.add("cursor-n"),body.classList.remove("cursor-none")}),e.addEventListener("mouseover",function(){mouseCursor.classList.add("cursor"),mouseCursor.classList.remove("cursor-n"),body.classList.add("cursor-none")})});body=document.querySelector("body");var detailsWrapper,detailsInfo,detailsContainer,detailsList,detailsListSecondary,tabs,tabsContent,buttonToWatch,buttonToQueue,ourTeamModal,selectedMovie,filmDetailsTimeout,detailsButtonClose,footerTheme=document.querySelector("footer"),textFooter=document.querySelector(".footer-text-wrapper"),copyrightFooter=document.querySelector(".footer-copyright"),creatorsFooter=document.querySelector(".footer-creators"),switchToggle=document.querySelector("#theme-switch-toggle"),paginationButton=document.querySelector(".pagination__button"),Theme={LIGHT:"light-theme",DARK:"dark-theme"};function getStorage(){var e=localStorage.getItem("Theme:");null===e||"light-theme"===e?(setLocalStorage(Theme.LIGHT),lightTheme()):"dark-theme"===e&&darkTheme()}function darkTheme(){body.classList.add("darkTheme"),footerTheme.classList.add("darkTheme"),textFooter.classList.add("darkTheme"),copyrightFooter.classList.add("darkTheme"),paginationButton.classList.add("darkTheme"),creatorsFooter.classList.add("darkTheme"),detailsModal&&(setDetailsFilmThemeToggling(),detailsWrapper.classList.add("darkTheme"),detailsInfo.classList.add("darkTheme"),detailsContainer.classList.add("darkTheme"),detailsList.classList.add("darkTheme"),detailsListSecondary.classList.add("darkTheme"),tabs.classList.add("darkTheme"),tabsContent.classList.add("darkTheme"),buttonToWatch.classList.add("darkTheme"),buttonToQueue.classList.add("darkTheme")),modal&&(setOurTeamThemeToggling(),ourTeamModal.classList.add("darkTheme")),switchToggle.checked=!0}function lightTheme(){body.classList.remove("darkTheme"),footerTheme.classList.remove("darkTheme"),textFooter.classList.remove("darkTheme"),copyrightFooter.classList.remove("darkTheme"),creatorsFooter.classList.remove("darkTheme"),detailsModal&&(setDetailsFilmThemeToggling(),detailsWrapper.classList.remove("darkTheme"),detailsInfo.classList.remove("darkTheme"),detailsContainer.classList.remove("darkTheme"),detailsList.classList.remove("darkTheme"),detailsListSecondary.classList.remove("darkTheme"),tabs.classList.remove("darkTheme"),tabsContent.classList.remove("darkTheme"),buttonToWatch.classList.remove("darkTheme"),buttonToQueue.classList.remove("darkTheme")),modal&&(setOurTeamThemeToggling(),ourTeamModal.classList.remove("darkTheme")),paginationButton.classList.remove("darkTheme"),switchToggle.checked=!1}function themeChange(){switchToggle.checked?(darkTheme(),setLocalStorage(Theme.DARK)):(lightTheme(),setLocalStorage(Theme.LIGHT))}function setLocalStorage(e){localStorage.setItem("Theme:",e)}function setDetailsFilmThemeToggling(){detailsWrapper=document.querySelector(".details-wrapper"),detailsInfo=document.querySelector(".details-information"),detailsContainer=document.querySelector(".details-container"),detailsList=document.querySelector(".details-inf-list"),detailsListSecondary=document.querySelector(".details-inf-list-secondary"),tabs=document.querySelector(".tabs"),tabsContent=document.querySelector(".tabs-content"),buttonToWatch=document.querySelector(".button-add-to-watch"),buttonToQueue=document.querySelector(".button-add-to-queue")}function setOurTeamThemeToggling(){ourTeamModal=document.querySelector(".modal-content")}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function _iterableToArray(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}switchToggle.addEventListener("click",themeChange),getStorage();var tabLinks=null,tabPanels=null,watchedButtonAdd=null,queueButtonAdd=null;function onFilmCardClickHandler(e){if("IMG"===e.target.nodeName){var t=e.target.dataset.id;activateDetailsPage(t),toggleButtonWatcher(t)}}function activateDetailsPage(t,e){openMovieDetails(selectedMovie=e?watchedAndQueueFilms.find(function(e){return e.id===Number(t)}):renderedMovies.find(function(e){return e.id===Number(t)}))}function openMovieDetails(e){toTopBtn&&toTopBtn.classList.remove("show"),shadowShow(),body.insertAdjacentHTML("beforeend",renderDetailFilmModal(e)),detailsModal=document.querySelector("#js-detailsPage"),queueButtonAdd=document.querySelector(".button-add-to-queue"),watchedButtonAdd=document.querySelector(".button-add-to-watch"),tabPanels=document.querySelectorAll(".tabs-panel"),tabLinks=document.querySelectorAll(".tabs a"),filmDetailsTimeout=setTimeout(function(){detailsModal.classList.remove("hidden"),detailsModal.classList.add("modal--active")},500),queueButtonAdd=document.querySelector(".button-add-to-queue"),detailsButtonClose=document.querySelector(".close-details"),getStorage(),detailsButtonClose.addEventListener("click",closeModal),window.removeEventListener("mousemove",cursor),window.addEventListener("mousemove",cursorHandler.mousemove),detailsModal.addEventListener("mouseover",cursorHandler.onmouseover),detailsModal.addEventListener("mouseout",cursorHandler.onmouseout),window.addEventListener("keydown",onEscapeCloseDetails),document.addEventListener("click",onOverlayDetailsClose),document.querySelector("#details-genre").textContent=setFilmGenres(e),fetchMovies(e.id).then(function(e){null!==e?document.getElementById("js-movieTrailer").innerHTML='\n        <iframe\n            src="https://www.youtube.com/embed/'.concat(e,'"\n            frameborder="0"\n            allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture"\n            allowfullscreen\n        ></iframe>\n  '):document.getElementById("js-movieTrailer").insertAdjacentHTML("beforeend",'<div style="background-color: tomato; color: teal; height: 200px;font-size: 20px; padding: 10px"> Короче, немає тут ніякого трейлера</div>')}),document.querySelector(".modal")?focusCatcher(modal):(focusCatcher(html),bodyScrollControlShift(),scrollPositionOnOpen(),html.classList.add("modal__opened")),tabLinks.forEach(function(e){return e.addEventListener("click",tabLinksCallback)}),runLocalStorage(),focusSet(detailsModal),detailsModal.querySelector(FOCUSABLE_SELECTORS).focus(),trapScreenReaderFocus(detailsModal)}function setFilmGenres(e){var t;return e.genre_ids?t=genres.filter(function(t){if(e.genre_ids)return!!e.genre_ids.find(function(e){return t.id===e})}).reduce(function(e,t){return e+"".concat(t.name,", ")},"").slice(0,-2):e.genres&&(t=e.genres.reduce(function(e,t){return e+"".concat(t.name,", ")},"")),t}function closeModal(){toTopBtn&&!modal&&toTopBtn.classList.add("show"),document.querySelector("iframe")&&(document.querySelector("iframe").src=""),detailsModal.classList.add("hidden"),detailsModal.classList.add("modal--moved"),detailsModal.addEventListener("transitionend",transitionDetailsClose),detailsModal.classList.remove("modal--active"),detailsButtonClose.removeEventListener("click",closeModal)}function transitionDetailsClose(){detailsModal.classList.remove("modal--moved"),detailsModal.removeEventListener("transitionend",transitionDetailsClose),modal||(window.removeEventListener("mousemove",cursorHandler.mousemove),detailsModal.removeEventListener("mouseover",cursorHandler.onmouseover),detailsModal.removeEventListener("mouseout",cursorHandler.onmouseout),cursorHandler.onclose(),window.addEventListener("mousemove",cursor),focusSet(html),bodyScrollControlShift(),scrollPositionOnClose(),body.removeChild(shadow),shadow=null),window.removeEventListener("keydown",onEscapeCloseDetails),document.removeEventListener("click",onOverlayDetailsClose),untrapScreenReaderFocus(detailsModal),clearTimeout(filmDetailsTimeout),filmDetailsTimeout=null,openModalBtn.focus(),body.removeChild(detailsModal),detailsButtonClose=selectedMovie=queueButtonAdd=watchedButtonAdd=tabPanels=tabLinks=detailsModal=null}function onEscapeCloseDetails(e){if(27==e.which&&detailsModal.classList.contains("details-container"))return e.preventDefault(),void closeModal()}function onOverlayDetailsClose(e){e.target.classList.contains("details-container")&&(e.preventDefault(),closeModal())}function tabLinksCallback(e){e.preventDefault(),document.querySelector(".tabs li.active").classList.remove("active"),document.querySelector(".tabs-panel.active").classList.remove("active");var t=e.target.parentElement;t.classList.add("active");var o=_toConsumableArray(t.parentElement.children).indexOf(t);_toConsumableArray(tabPanels).filter(function(e){return e.getAttribute("data-index")==o})[0].classList.add("active")}function toggleButtonWatcher(o){var e=a("filmsWatched"),t=a("filmsQueue");function a(e){return JSON.parse(localStorage.getItem("".concat(e)))}null!==e&&(e.includes(o)&&homePageLink.classList.contains("current")?(watchedButtonAdd.classList.add("button-is-active"),watchedButtonAdd.textContent="IN WATCHED"):myLibraryLink.classList.contains("current")&&watchedButton.classList.contains("button-active")&&e.includes(o)?(watchedButtonAdd.classList.add("button-is-active"),watchedButtonAdd.textContent="DELETE",watchedButtonAdd.addEventListener("click",function(){var t;libraryGallery.querySelectorAll("img[data-id]").forEach(function(e){e.dataset.id==o&&(t=e)}),libraryGallery.removeChild(t.parentNode),closeModal()})):(watchedButtonAdd.classList.remove("button-is-active"),watchedButtonAdd.textContent="ADD TO WATCHED")),null!==t&&(t.includes(o)&&homePageLink.classList.contains("current")?(queueButtonAdd.classList.add("button-is-active"),queueButtonAdd.textContent="IN QUEUE"):myLibraryLink.classList.contains("current")&&queueButton.classList.contains("button-active")&&t.includes(o)?(queueButtonAdd.classList.add("button-is-active"),queueButtonAdd.textContent="DELETE",queueButtonAdd.addEventListener("click",function(){var t;libraryGallery.querySelectorAll("img[data-id]").forEach(function(e){e.dataset.id==o&&(t=e)}),libraryGallery.removeChild(t.parentNode),closeModal()})):(queueButtonAdd.classList.remove("button-is-active"),queueButtonAdd.textContent="ADD TO QUEUE"))}function runLocalStorage(){function a(e){return JSON.parse(localStorage.getItem("".concat(e)))}function n(e,t){localStorage.setItem("".concat(e),JSON.stringify(t))}function o(e,t){var o=a(e);o.push(t),n(e,o)}function r(e,t){var o=a(e);o.splice(a(e).indexOf(t),1),n(e,o)}watchedButtonAdd.addEventListener("click",function(){var e=document.querySelector(".details-img").dataset.filmid,t=a("filmsWatched");null===t?(watchedButtonAdd.classList.add("button-is-active"),watchedButtonAdd.textContent="IN WATCHED",localStorage.setItem("filmsWatched",JSON.stringify([e])),writeUserWatchedFilm(e)):t.includes(e)?(watchedButtonAdd.classList.remove("button-is-active"),watchedButtonAdd.textContent="ADD TO WATCHED",r("filmsWatched",e),removeUserWatchedFilm(e)):(watchedButtonAdd.classList.add("button-is-active"),watchedButtonAdd.textContent="IN WATCHED",o("filmsWatched",e),writeUserWatchedFilm(e))}),queueButtonAdd.addEventListener("click",function(){var e=document.querySelector(".details-img").dataset.filmid,t=a("filmsQueue");null===t?(queueButtonAdd.classList.add("button-is-active"),queueButtonAdd.textContent="IN QUEUE",localStorage.setItem("filmsQueue",JSON.stringify([e])),writeUserQueueFilm(e)):t.includes(e)?(queueButtonAdd.classList.remove("button-is-active"),queueButtonAdd.textContent="ADD TO QUEUE",r("filmsQueue",e),removeUserQueueFilm(e)):(queueButtonAdd.classList.add("button-is-active"),queueButtonAdd.textContent="IN QUEUE",o("filmsQueue",e),writeUserQueueFilm(e))})}fetchGenres(),document.querySelector(".footer-copyright-year").innerHTML=(new Date).getFullYear();var buttonsNumbers=[-1,0,1,2,3];function clickerInit(){document.querySelector(".pagination").addEventListener("click",function(e){switch(e.target.dataset.index){case"left":renderNumbers(buttonsNumbers=previousPage(buttonsNumbers)),paginationNavigation(buttonsNumbers),scrollToSectionHomePage(),dischargeHeaderError();break;case"right":renderNumbers(buttonsNumbers=nextPage(buttonsNumbers)),paginationNavigation(buttonsNumbers),scrollToSectionHomePage(),dischargeHeaderError();break;case"1":renderNumbers(buttonsNumbers=previousTwoPage(buttonsNumbers)),paginationNavigation(buttonsNumbers),scrollToSectionHomePage(),dischargeHeaderError();break;case"2":renderNumbers(buttonsNumbers=previousPage(buttonsNumbers)),paginationNavigation(buttonsNumbers),scrollToSectionHomePage(),dischargeHeaderError();break;case"3":case"4":renderNumbers(buttonsNumbers=nextPage(buttonsNumbers)),paginationNavigation(buttonsNumbers),scrollToSectionHomePage(),dischargeHeaderError();break;case"5":renderNumbers(buttonsNumbers=nextTwoPage(buttonsNumbers)),paginationNavigation(buttonsNumbers),scrollToSectionHomePage(),dischargeHeaderError()}1<Number(buttonThreeRef.textContent)?(buttonLeftRef.classList.remove("pagination__button_disabled"),buttonTwoRef.classList.remove("pagination__button_is-hidden")):(buttonLeftRef.classList.add("pagination__button_disabled"),buttonTwoRef.classList.add("pagination__button_is-hidden")),2<Number(buttonThreeRef.textContent)?buttonOneRef.classList.remove("pagination__button_is-hidden"):buttonOneRef.classList.add("pagination__button_is-hidden")})}function renderNumbers(o){Array.from(document.querySelectorAll(".pagination__number")).forEach(function(e,t){e.textContent=o[t],e.textContent<1?(e.textContent="",e.classList.add("pagination__button_disabled")):e.classList.remove("pagination__button_disabled")})}function nextPage(e){return e.map(function(e){return e+1})}function nextTwoPage(e){return e.map(function(e){return e+2})}function previousPage(e){return e.map(function(e){return e-1})}function previousTwoPage(e){return e.map(function(e){return e-2})}function dischargePaginationAndCreateMarkup(){buttonLeftRef.classList.add("pagination__button_disabled"),buttonOneRef.classList.add("pagination__button_is-hidden"),buttonTwoRef.classList.add("pagination__button_is-hidden"),renderNumbers(buttonsNumbers=[-1,0,1,2,3]),paginationNavigation(buttonsNumbers)}function scrollToSectionHomePage(){var e=window.matchMedia("(max-width: 767px)");function t(e){e.matches?window.scrollTo({top:240,behavior:"smooth"}):window.scrollTo({top:670,behavior:"smooth"})}e.addListener(t),t(e)}function dischargeHeaderError(){"No movies were found. Please specify your request"===headerError.textContent&&(inputValue="",searchField.reset())}clickerInit();var toTopBtn=document.getElementById("to-top-button");function _defineProperty(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}window.addEventListener("scroll",function(){300<document.documentElement.scrollTop?toTopBtn.classList.add("show"):toTopBtn.classList.remove("show")}),toTopBtn.addEventListener("click",function(e){e.preventDefault(),window.scrollTo({top:0,behavior:"smooth"})});var registrationButton=document.querySelector(".register-button"),logInButton=document.querySelector(".log-in-button"),openRegistrFormButton=document.querySelector(".button_registration"),openLogInFormButton=document.querySelector(".button_logIn"),signOutButton=document.querySelector(".button_signOut"),registrationMail=document.querySelector(".registration .mail"),registrationPass=document.querySelector(".registration .pass"),logInMail=document.querySelector(".logIn .mail"),logInPass=document.querySelector(".logIn .pass"),formModal=document.querySelector(".form-modal"),formButtonClose=document.querySelector(".form-button-close"),registrationForm=document.querySelector(".registration"),logInForm=document.querySelector(".logIn"),user=localStorage.userId;function toggleButtonLogIn(){isLogIn()?(openRegistrFormButton.style.opacity="0",openRegistrFormButton.style.pointerEvents="none",openLogInFormButton.innerHTML="<svg class='button-icon'><use href='./images/sprite.svg#signout'></use></svg>"):(openRegistrFormButton.style.opacity="1",openRegistrFormButton.style.pointerEvents="auto",openLogInFormButton.innerHTML="<svg class='button-icon'><use href='./images/sprite.svg#login'></use></svg>")}function openRegistrationModal(){formModal.classList.remove("hidden"),body.classList.add("blocked-scroll"),registrationForm.classList.remove("hidden")}function openLogINModal(){formModal.classList.remove("hidden"),body.classList.add("blocked-scroll"),logInForm.classList.remove("hidden")}function closeFormModal(e){(e.target.classList.contains("form-modal")||e.target.classList.contains("form-close")||"use"===e.target.nodeName||"Escape"===e.key)&&(body.classList.remove("blocked-scroll"),formModal.classList.add("hidden"),registrationForm.classList.add("hidden"),logInForm.classList.add("hidden")),toggleButtonLogIn()}function createUser(e,t){firebase.auth().createUserWithEmailAndPassword(e,t).then(function(e){user=e.user.uid}).catch(function(e){e.code,e.message})}function logInUser(e,t){firebase.auth().signInWithEmailAndPassword(e,t).then(function(e){user=e.user.uid,localStorage.setItem("userId",user)}).catch(function(e){e.code,e.message})}function signOut(){user=void 0,localStorage.removeItem("userId")}function writeUserWatchedFilm(e){firebase.database().ref("users/"+user+"/watched").update(_defineProperty({},e,!0))}function writeUserQueueFilm(e){firebase.database().ref("users/"+user+"/queue").update(_defineProperty({},e,!0))}function removeUserWatchedFilm(e){firebase.database().ref("users/"+user+"/watched/"+e).remove()}function removeUserQueueFilm(e){firebase.database().ref("users/"+user+"/queue/"+e).remove()}toggleButtonLogIn(),openRegistrFormButton.addEventListener("click",function(e){e.preventDefault(),openRegistrationModal()}),openLogInFormButton.addEventListener("click",function(e){e.preventDefault(),isLogIn()?(signOut(),openLogInFormButton.innerHTML="<svg class='button-icon'><use href='./images/sprite.svg#login'></use></svg>",toggleButtonLogIn()):openLogINModal()}),registrationButton.addEventListener("click",function(e){e.preventDefault(),createUser(registrationMail.value,registrationPass.value),registrationMail.value="",registrationPass.value=""}),logInButton.addEventListener("click",function(e){e.preventDefault(),logInUser(logInMail.value,logInPass.value),logInMail.value="",logInPass.value=""}),formButtonClose.addEventListener("click",closeFormModal),formModal.addEventListener("click",closeFormModal),document.addEventListener("keydown",closeFormModal);var userWatchedRef=firebase.database().ref("users/"+user+"/watched/");function updateUserWatched(){userWatchedRef.on("value",function(e){e.val()?localStorage.setItem("filmsWatched",JSON.stringify(Object.keys(e.val()))):localStorage.removeItem("filmsWatched")})}var userQueueRef=firebase.database().ref("users/"+user+"/queue/");function updateUserQueue(){userQueueRef.on("value",function(e){e.val()?localStorage.setItem("filmsQueue",JSON.stringify(Object.keys(e.val()))):localStorage.removeItem("filmsQueue")})}function isLogIn(){return void 0!==user}updateUserQueue(),updateUserWatched();var collaborators=[{src:"./images/Margot_Robbie_cr.jpg",alt:"Margot Robbie",collaboratorName:"Yuliia",filmName:"alibi.com"},{src:"./images/Natalie_Portman_cr.jpg",alt:"Natalie Portman",collaboratorName:"Valentina",filmName:"Leon: The Professional"},{src:"./images/Charlie_Hunnam.png",alt:"Charlie Hunnam",collaboratorName:"Max",filmName:"Escape from Pretoria"},{src:"./images/Til_Schweiger_cr.jpg",alt:"Til Schweiger",collaboratorName:"Mikhail",filmName:"Knockin` on Heaven`s Door"},{src:"./images/AbdulovA.jpg",alt:"Aleksandr Abdulov",collaboratorName:"Dmytro",filmName:"Charodei"},{src:"./images/Johnny_Depp.jpg",alt:"Johnny Depp",collaboratorName:"Dimas",filmName:"Fear and Loathing in Las Vegas"},{src:"./images/Adam_Sandler.jpg",alt:"Adam Sandler",collaboratorName:"Victor",filmName:"Big Daddy"},{src:"./images/Tim_Robbins.jpg",alt:"Tim Robbins",collaboratorName:"Sergey",filmName:"The Shawshank Redemption"}];function renderCollaboratorCard(e){return'\n    <li class="modal-our_team_item">\n        <div class="modal-our_tem_card-wrapper">\n            <div class="modal_window-thumb">\n                <img class="modal_window-img" src="'.concat(e.src,'" alt="').concat(e.alt,'">\n            </div>\n            <p class="modal-developer_name">').concat(e.collaboratorName,'</p>\n            <button class="modal-card_btn">\n                <span class="modal-card_btn_text">\n                    ').concat(e.filmName,"\n                </span>\n            </button>\n        </div>\n    </li>\n    ")}function renderDetailFilmModal(e){return'\n    <div id="js-detailsPage" class="details-container details-page hidden">\n  <div class="details-wrapper">\n    <img\n      id="js-previewImg"\n      class="details-img"\n      src="https://image.tmdb.org/t/p/w500/'.concat(e.poster_path?e.poster_path:"./images/plug.jpg",'"\n      alt="film-preview"\n      width="100%"\n      height="100%"\n      data-filmId=').concat(e.id,'\n    />\n    <div class="details-information">\n      <button class="button-close close-details">\n        <svg class="details-close">\n          <use href="./images/symbol-defs.svg#close"></use>\n        </svg>\n      </button>\n      <h1 class="details-title">').concat(e.title?e.title:"a fistful of lead",'</h1>\n      <div class="details-inf">\n        <ul class="details-inf-list">\n          <li>Vote / Votes</li>\n          <li>Popularity</li>\n          <li>Original Title</li>\n          <li>Genre</li>\n        </ul>\n        <ul class="details-inf-list details-inf-list-secondary">\n          <li>\n            <span id="js-detailsVote" class="text-orange">').concat(e.vote_average?e.vote_average:"0.0",'</span>\n            <span id="js-detailsVotes">/').concat(e.vote_count?e.vote_count:"0000",'</span>\n          </li>\n          <li id="details-popularity">').concat(e.popularity?e.popularity:"100.2",'</li>\n          <li id="details-originalTitle">').concat(e.original_title?e.original_title:"a fistful of lead",'</li>\n          <li id="details-genre">Western</li>\n        </ul>\n      </div>\n\n      <div class="tabs-container">\n        <ul class="tabs">\n          <li class="active">\n            <a href="">ABOUT</a>\n          </li>\n          <li>\n            <a href="">TRAILER</a>\n          </li>\n        </ul>\n        <div class="tabs-content">\n          <div\n            id="js-detailsText"\n            class="tabs-panel active"\n            data-index="0"\n          >').concat(e.overview,'</div>\n          <div\n            id="js-movieTrailer"\n            class="movie-trailer tabs-panel"\n            data-index="1"\n          ></div>\n          <div class="tabs-panel" data-index="2">\n            <p></p>\n          </div>\n        </div>\n      </div>\n\n      <div class="details-button-list">\n        <button class="details-button button-add-to-watch">\n          add to Watched\n        </button>\n        <button class="details-button button-add-to-queue">add to queue</button>\n      </div>\n    </div>\n  </div>\n</div>\n    ')}function createModalWindow(){return'\n    <div class="modal" role="dialog" aria-labelledby="Modal_Title" aria-describedby="Modal_Description" aria-hidden="true" >\n    <div class="modal-wrap">\n        <div class="modal-content">\n             <button class="button-close close-modal">\n                <svg class="details-close">\n                    <use href="./images/symbol-defs.svg#close"></use>\n                </svg>\n            </button>\n            <h2 id="modal_Title">Our team</h2>\n            <ul class="modal-our_team_list">\n                \n            </ul> \n        </div>\n    </div>\n  </div>\n</div>\n    '}